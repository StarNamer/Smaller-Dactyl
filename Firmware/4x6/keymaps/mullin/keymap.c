#include "small_dactyl.h"
#include "action_layer.h"
#include "eeconfig.h"

extern keymap_config_t keymap_config;

#define COLEMAK 0
#define _QWERTY 1
#define SYM 2
#define NUM 3
#define NAV 4
#define _FUNC 5



// Fillers to make layering more clear

#define ____ KC_TRNS

#define SFT_Z  SFT_T(KC_Z)

#define SELALL LCTL(KC_A)
#define CTLESC LCTL(KC_ESC)
#define STAB LSFT(KC_TAB)
#define NUMDEL LT(NUM, KC_DEL)
#define ESCNAV LT(NAV, KC_ESC)
#define NUMENT LT(NUM, KC_ENT)
#define OSMNAV OSL(NAV)
#define OSMNUM OSL(NUM)
#define OSMSYM OSL(SYM)
#define REDO LCTL(KC_Y)
#define SCR_UP LCTL(KC_UP)
#define SCR_DN LCTL(KC_DOWN)

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

[_QWERTY] = LAYOUT( \
//  ┌────────┬────────┬────────┬────────┬────────┬────────┐                   ┌────────┬────────┬────────┬────────┬────────┬────────┐
      KC_TAB ,  KC_Q  ,  KC_W  ,  KC_E  ,  KC_R  ,  KC_T  ,                      KC_Y  ,  KC_U  ,  KC_I  ,  KC_O  ,  KC_P  ,KC_BSLS ,
//  ├────────┬────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      KC_ESC ,  KC_A  ,  KC_S  ,  KC_D  ,  KC_F  ,  KC_G  ,                      KC_H  ,  KC_J  ,  KC_K  ,  KC_L  , KC_SCLN, KC_QUOT,
//  ├────────┼────────┼────────┼────────┼────────┼────────┼                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      KC_LSFT,  KC_Z  ,  KC_X  ,  KC_C  ,  KC_V  ,  KC_B  ,                      KC_N  ,  KC_M  ,KC_COMM , KC_DOT ,KC_SLSH ,KC_RSFT ,
//  └────────┴────────┴────────┴────────┼────────┼────────┼────────┐ ┌────────┴────────┴────────┴────────┴────────┴────────┴────────┘
                                         KC_LCTL , KC_SPC , KC_DEL ,   KC_ENT , KC_BSPC, KC_LALT
//                                      └────────┴────────┴────────┘ └────────┴────────┴────────┘
),

[COLEMAK] = LAYOUT( \
//  ┌────────┬────────┬────────┬────────┬────────┬────────┐                   ┌────────┬────────┬────────┬────────┬────────┬────────┐
      ____   ,  KC_Q  ,  KC_W  ,  KC_F  , KC_P   , KC_G   ,                     KC_J   , KC_L   , KC_U   , KC_Y   ,KC_SCLN ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      ____   ,  KC_A  ,  KC_R  ,  KC_S  , KC_T   , KC_D   ,                     KC_H   , KC_N   , KC_E   , KC_I   , KC_O   ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      ____   ,  KC_Z  ,  KC_X  ,  KC_C  , KC_V   , KC_B   ,                     KC_K   , KC_M   ,KC_COMM  ,KC_DOT  ,KC_SLSH,  ____  ,
//  └────────┴────────┴────────┴────────┼────────┼────────┼────────┐ ┌────────┴────────┴────────┴────────┴────────┴────────┴────────┘
                                          KC_LCTL , KC_SPC , KC_DEL ,   KC_ENT , KC_BSPC, KC_LALT
//                                      └────────┴────────┴────────┘ └────────┴────────┴────────┘
),

[NAV] = LAYOUT( \
//  ┌────────┬────────┬────────┬────────┬────────┬────────┐                   ┌────────┬────────┬────────┬────────┬────────┬────────┐
      ____   ,KC_ENT  ,STAB    , KC_TAB ,KC_ESC  ,KC_DEL  ,                      STAB  ,KC_PGUP ,KC_UP   ,KC_PGDN ,KC_LGUI ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      ____   ,KC_LCTL ,KC_LGUI ,KC_LSFT ,KC_LALT ,KC_BSPC ,                    KC_BSPC ,KC_LEFT ,KC_DOWN ,KC_RGHT ,KC_ENT  ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      ____   ,KC_UNDO ,KC_CUT  ,KC_COPY ,KC_PASTE,DF(COLEMAK),                  KC_TAB ,KC_HOME  ,KC_DEL   ,KC_END   ,REDO ,  ____  ,
//  └────────┴────────┴────────┴────────┼────────┼────────┼────────┐ ┌────────┴────────┴────────┴────────┴────────┴────────┴────────┘
                                         KC_LCTL , KC_SPC , KC_DEL ,   KC_ENT , KC_BSPC, KC_LALT
//                                      └────────┴────────┴────────┘ └────────┴────────┴────────┘
),

[NUM] = LAYOUT( \
//  ┌────────┬────────┬────────┬────────┬────────┬────────┐                   ┌────────┬────────┬────────┬────────┬────────┬────────┐                                                                                                                                                                                                                                                            5
      ____   ,KC_EXLM ,  STAB  , KC_TAB , KC_EQL , KC_DEL ,                    KC_MINS , KC_7   , KC_8   , KC_9   ,KC_ASTR ,  ____  ,                                                                                                                                                                                                                                                            5
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤                                                                                                                                                                                                                                                            5
      ____   ,KC_LCTL ,KC_LGUI ,KC_LSFT,KC_LALT ,KC_AMPR  ,                     KC_BSPC , KC_4   , KC_5   , KC_6   ,KC_ENT ,  ____  ,                                                                                                                                                                                                                                                            5
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤                                                                                                                                                                                                                                                            5
      ____   ,KC_LPRN , KC_LT  ,KC_PERC ,KC_GT   ,KC_RPRN ,                    KC_PLUS , KC_1   , KC_2   , KC_3   ,KC_SLSH ,  ____  ,                                                                                                                                                                                                                                                            5
//  └────────┴────────┴────────┴────────┼────────┼────────┼────────┐ ┌────────┴────────┴────────┴────────┴────────┴────────┴────────┘                                                                                                                                                                                                                                                            5
                                         KC_LCTL , KC_SPC , KC_DEL ,   KC_ENT , KC_BSPC, KC_LALT
//                                      └────────┴────────┴────────┘ └────────┴────────┴────────┘
),

[SYM] = LAYOUT( \
//  ┌────────┬────────┬────────┬────────┬────────┬────────┐                   ┌────────┬────────┬────────┬────────┬────────┬────────┐
      ____   ,KC_SCLN ,KC_MINS ,KC_DQT  ,KC_PLUS ,KC_PIPE ,                    KC_BSLS ,KC_RCBR ,KC_RPRN ,KC_RBRC ,KC_GT   ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      ____   ,KC_COLN ,KC_UNDS ,KC_QUOT ,KC_EQL  ,KC_AMPR  ,                   KC_SLSH ,KC_LCBR ,KC_LPRN ,KC_LBRC ,KC_LT   ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┼                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      ____   ,KC_EXLM ,KC_QUES , KC_AT  ,KC_DLR  ,KC_ASTR ,                    KC_HASH ,KC_CIRC ,KC_PERC ,KC_TILD ,KC_GRV  ,  ____  ,
//  └────────┴────────┴────────┴────────┼────────┼────────┼────────┐ ┌────────┴────────┴────────┴────────┴────────┴────────┴────────┘
                                         KC_LCTL , KC_SPC , KC_DEL ,   KC_ENT , KC_BSPC, KC_LALT
//                                      └────────┴────────┴────────┘ └────────┴────────┴────────┘
),

[_FUNC] = LAYOUT( \
//  ┌────────┬────────┬────────┬────────┬────────┬────────┐                   ┌────────┬────────┬────────┬────────┬────────┬────────┐
      ____   , KC_SCLN,  KC_Y  ,  KC_U  ,  KC_L  ,  KC_J  ,                     SCR_UP , KC_F7  , KC_F8  ,KC_RBRC , KC_GT  ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┤                   ├────────┼────────┼────────┼────────┼────────┼────────┤
      ____   ,  KC_O  ,  KC_I  ,  KC_E  ,  KC_N  ,  KC_H  ,                     KC_INS , KC_F4  , KC_F5  , KC_F6  , KC_LT  ,  ____  ,
//  ├────────┼────────┼────────┼────────┼────────┼────────┼                   ┼────────┼────────┼────────┼────────┼────────┼────────┤
      ____   , KC_SLSH, KC_DOT ,KC_COMM ,  KC_M  ,  KC_K  ,                     SCR_DN , KC_F1  , KC_F2  , KC_F3  , KC_GRV ,  ____  ,
//  └────────┴────────┴────────┴────────┼────────┼────────┼────────┐ ┌────────┴────────┴────────┴────────┴────────┴────────┴────────┘
                                         KC_LCTL , KC_SPC , KC_DEL ,   KC_ENT , KC_BSPC, KC_LALT
//                                      └────────┴────────┴────────┘ └────────┴────────┴────────┘
)
};

void persistent_default_layer_set(uint16_t default_layer) {
  eeconfig_update_default_layer(default_layer);
  default_layer_set(default_layer);
}

